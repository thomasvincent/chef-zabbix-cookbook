---
# Apache HTTP Server YAML Configuration
# Generated by Chef - DO NOT EDIT

server:
  root: <%= @server_root %>
  name: <%= @server_name %>
  admin: <%= @server_admin %>
  hostname_lookups: "<%= @hostname_lookups %>"
  timeout: <%= @timeout %>
  keep_alive: "<%= @keep_alive %>"
  keep_alive_timeout: <%= @keep_alive_timeout %>
  keep_alive_requests: <%= @max_keep_alive_requests %>
  user: <%= @user %>
  group: <%= @group %>

listen:
<% @listen.each do |listen_directive| %>
  - <%= listen_directive %>
<% end %>

directories:
<% @directories.each do |directory| %>
  - path: "<%= directory['path'] %>"
    options: "<%= directory['options'] %>"
    allow_override: "<%= directory['allow_override'] %>"
    require: "<%= directory['require'] %>"
<% end %>

modules:
<% @modules.each do |mod| %>
  - <%= mod %>
<% end %>

mpm:
  type: <%= @mpm %>
  server_limit: <%= @mpm_config['server_limit'] %>
  max_request_workers: <%= @mpm_config['max_request_workers'] %>
  threads_per_child: <%= @mpm_config['threads_per_child'] %>
  max_connections_per_child: <%= @mpm_config['max_connections_per_child'] %>

logs:
  level: <%= @log_level %>
  error_log: <%= @error_log %>
  access_log: <%= @access_log %>
  formats:
    combined: <%= @log_formats['combined'] %>
    common: <%= @log_formats['common'] %>
    json: <%= @log_formats['json'] %>

security:
  server_tokens: <%= @server_tokens %>
  server_signature: <%= @server_signature %>
  trace_enable: <%= @trace_enable %>

<% if @enable_http2 %>
http2:
  enabled: true
<% end %>

<% if @ssl_enabled %>
ssl:
  enabled: true
  port: <%= @ssl_port %>
  protocol: <%= @ssl_protocol.join(' ') %>
  cipher_suite: <%= @ssl_cipher_suite %>
  honor_cipher_order: <%= @ssl_honor_cipher_order %>
  certificate: <%= @ssl_certificate %>
  certificate_key: <%= @ssl_certificate_key %>
  <% if @ssl_certificate_chain %>
  certificate_chain: <%= @ssl_certificate_chain %>
  <% end %>
  hsts:
    enabled: <%= @hsts_enabled %>
    max_age: <%= @hsts_max_age %>
    include_subdomains: <%= @hsts_include_subdomains %>
    preload: <%= @hsts_preload %>
<% end %>

<% if @additional_config %>
additional_config:
<% @additional_config.each do |key, value| %>
  <%= key %>: <%= value.to_yaml.gsub(/^---\n/, '') %>
<% end %>
<% end %>